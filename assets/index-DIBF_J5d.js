(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const t of document.querySelectorAll('link[rel="modulepreload"]'))s(t);new MutationObserver(t=>{for(const o of t)if(o.type==="childList")for(const n of o.addedNodes)n.tagName==="LINK"&&n.rel==="modulepreload"&&s(n)}).observe(document,{childList:!0,subtree:!0});function d(t){const o={};return t.integrity&&(o.integrity=t.integrity),t.referrerPolicy&&(o.referrerPolicy=t.referrerPolicy),t.crossOrigin==="use-credentials"?o.credentials="include":t.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function s(t){if(t.ep)return;t.ep=!0;const o=d(t);fetch(t.href,o)}})();const i={url:"https://lf-se-fellowship-node-assignment-todos.onrender.com",todos:"todos",create:"create",update:"update",del:"delete",login:"login",register:"register"};var a="";document.addEventListener("DOMContentLoaded",()=>{const r=document.getElementById("loginForm"),e=document.getElementById("loginMessage");r.addEventListener("submit",async d=>{d.preventDefault();const s=document.getElementById("email").value,t=document.getElementById("password").value;try{const o=await fetch(`${i.url}/${i.login}`,{method:"POST",body:JSON.stringify({email:s,password:t}),headers:{"Content-Type":"application/json"}});if(!o.ok)throw e.innerText="Network response was not ok",new Error("Network response was not ok");const n=await o.json();console.log(n),e.innerText=n,document.getElementById("login-container").style.display="none",document.getElementById("main-container").style.display="flex",a=btoa(`${s}:${t}`),c()}catch(o){console.error("Error Logging In:",o),e.innerText="Invalid Credentials"}}),document.getElementById("registerButton").addEventListener("click",async function(){const d=document.getElementById("email").value,s=document.getElementById("password").value;try{const t=await fetch(`${i.url}/${i.register}`,{method:"POST",body:JSON.stringify({email:d,password:s}),headers:{"Content-Type":"application/json"}});if(!t.ok)throw e.innerText="Network response was not ok",new Error("Network response was not ok");const o=await t.json();console.log(o),e.innerText=o,document.getElementById("login-container").style.display="none",document.getElementById("main-container").style.display="flex",a=btoa(`${d}:${s}`),c()}catch(t){console.error("Error Registering:",t),e.innerText="User Already Exists"}})});var y=[],l=null;const u=`${i.url}/${i.todos}`;document.getElementById("logout").addEventListener("click",()=>{a="",document.getElementById("login-container").style.display="block",document.getElementById("main-container").style.display="none"});async function c(){try{const r=await fetch(u,{method:"POST",headers:{Authorization:`Basic ${a}`}});if(!r.ok)throw new Error(`Response status: ${r.status}`);y=await r.json(),p()}catch(r){console.error(r)}}function p(){const r=document.getElementById("todosList");r.innerHTML="",y.forEach(e=>{const d=document.createElement("div");d.className="todo-item";const s=document.createElement("div");s.innerHTML=`
          <strong>${e.title}</strong> - ${e.description} - ${e.dueDate} - ${e.priority} - ${e.category}
      `;const t=document.createElement("div"),o=document.createElement("button");o.innerText="Delete",o.onclick=()=>f(e.id);const n=document.createElement("button");n.innerText="Edit",n.onclick=()=>h(e.id),t.appendChild(n),t.appendChild(o),d.appendChild(s),d.appendChild(t),r.appendChild(d)})}async function E(){const r=document.getElementById("title").value,e=document.getElementById("description").value,d=document.getElementById("dueDate").value,s=document.getElementById("priority").value,t=document.getElementById("category").value;if(r&&e&&d&&s&&t){const o={title:r,description:e,completed:!1,dueDate:d,priority:s,category:t};if(l){try{const n=await fetch(`${u}/${i.update}/${l}`,{method:"PUT",body:JSON.stringify(o),headers:{"Content-Type":"application/json",Authorization:`Basic ${a}`}});if(!n.ok)throw new Error("Failed to update todo");const m=await n.json();console.log(m),document.getElementById("add-todo").innerHTML="Add Todo",c(),g()}catch(n){console.error("Error updating todo:",n)}l=null}else try{const n=await fetch(`${u}/${i.create}`,{method:"POST",body:JSON.stringify(o),headers:{"Content-Type":"application/json",Authorization:`Basic ${a}`}});if(!n.ok)throw new Error("Failed to add todo");const m=await n.json();console.log(m),c(),g()}catch(n){console.error("Error adding todo:",n)}}else alert("Please fill in all fields")}async function f(r){try{const e=await fetch(`${u}/${i.del}/${r}`,{method:"DELETE",headers:{Authorization:`Basic ${a}`}});if(!e.ok)throw new Error("Failed to Delete todo");const d=await e.json();console.log(d),c()}catch(e){console.error("Error deleteing todo:",e)}}async function h(r){const e=y.find(({id:d})=>d==r);document.getElementById("title").value=e.title,document.getElementById("description").value=e.description,document.getElementById("dueDate").value=e.dueDate,document.getElementById("priority").value=e.priority,document.getElementById("category").value=e.category,document.getElementById("add-todo").innerHTML="Edit Todo",l=r}function g(){document.getElementById("title").value="",document.getElementById("description").value="",document.getElementById("dueDate").value="",document.getElementById("priority").value="High",document.getElementById("category").value=""}a&&c();const B=document.getElementById("add-todo");B.addEventListener("click",()=>{E()});
